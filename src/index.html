<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="./index.css">
  </head>

  <body>
    <div class="app-title">Steak Timer :3</div>
    <div class="window-controls">
      <button class="control-btn minimize-btn" id="minimizeBtn">
        <img src="./assets/Minimize-button.png" alt="Minimize" />
      </button>
      <button class="control-btn close-btn" id="closeBtn">
        <img src="./assets/Close-button.png" alt="Close" />
      </button>
    </div>


    <div class="home-content" id="home-content" style="display: block;">
      <h1 class="home-text">Let's Cook Some Meat!</h1>
      <p class="sub-text">( for a 1" steak )</p>
      <button class="start-button" id="startBtn">Start</button>
    </div>
    
    
    <div class="steak-rarity-view" id="steakRarity" style="display: none;">
      <h1 class="sub-text">How do you want your steak cooked today?</h1>
      <div class="steak-grid-container">
        <button class="steak-btn" id="rareSteakBtn">
          <img src="./assets/rare.png" alt="Rare" />
          <span class="steak-label">Rare</span>
        </button>
        
        <button class="steak-btn" id="mediumRareSteakBtn">
          <img src="./assets/medium-rare.png" alt="Medium Rare" />
          <span class="steak-label">Medium Rare</span>
        </button>

        <button class="steak-btn" id="mediumSteakBtn">
          <img src="./assets/medium.png" alt="Medium" />
          <span class="steak-label">Medium</span>
        </button>

        <button class="steak-btn" id="wellDoneSteakBtn">
          <img src="./assets/well-done.png" alt="Well Done" />
          <span class="steak-label">Well Done</span>
        </button>
      </div>
    </div>
    
    <div class="timer-view" id="timerView" style="display: none;">
      <h1 class="sub-text">Start Cooking!</h1>
      
      <div class="cooking-container">
        <img src="./assets/frying-pan.png" alt="Frying Pan" class="frying-pan" />
        <img src="./assets/rare.png" alt="Rare Steak" class="cooking-steak" />
        <div class="timer-display" id="timerDisplay" style="display: none;">2:30</div>
        <button class="start-button" id="startCookingBtn">Start</button>
      </div>
  
    </div>
    
    
    <script>
      // commands for when button is pushed.
      document.getElementById('closeBtn').addEventListener('click', () => {
        if (window.electronAPI) {
          window.electronAPI.closeWindow();
        }
      });

      document.getElementById('minimizeBtn').addEventListener('click', () => {
        if (window.electronAPI) {
          window.electronAPI.minimizeWindow();
        }
      });

      document.getElementById('startBtn').addEventListener('click', () => {
        document.getElementById('home-content').style.display = 'none';
        document.getElementById('steakRarity').style.display = 'block';
      });

      document.getElementById('rareSteakBtn').addEventListener('click', () => {
        document.getElementById('steakRarity').style.display = 'none';
        document.getElementById('timerView').style.display = 'block';
      });

      // Timer functionality
      function initializeTimer(time) {
        let timerInterval = null;
        let totalSeconds = time; // 2.5 minutes
        let remainingSeconds = 150;
        let hasFlipped = false;
        let flipTime = totalSeconds/2; // 1.25 minutes (midway point - when 75 seconds remain)

        const startCookingBtn = document.getElementById('startCookingBtn');
        const timerDisplay = document.getElementById('timerDisplay');

        function formatTime(seconds) {
          const mins = Math.floor(seconds / 60);
          const secs = seconds % 60;
          return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function updateTimer() {
          // Decrement first
          remainingSeconds--;
          timerDisplay.textContent = formatTime(remainingSeconds);
          
          // Check if timer is done
          if (remainingSeconds <= 0) {
            clearInterval(timerInterval);
            timerInterval = null;
            startCookingBtn.textContent = 'Done';
            timerDisplay.textContent = '0:00';
            // Hide timer, show button
            timerDisplay.style.display = 'none';
            startCookingBtn.style.display = 'block';
            return;
          }
          
          // Check if it's time to show flip button (at 1.25 minutes = 75 seconds remaining)
          if (remainingSeconds === flipTime && !hasFlipped) {
            clearInterval(timerInterval);
            timerInterval = null;
            startCookingBtn.textContent = 'Flip';
            // Hide timer, show button
            timerDisplay.style.display = 'none';
            startCookingBtn.style.display = 'block';
            return;
          }
        }

        startCookingBtn.addEventListener('click', () => {
          if (startCookingBtn.textContent === 'Start') {
            // Start the timer
            timerDisplay.style.display = 'block';
            startCookingBtn.style.display = 'none'; // Hide button when timer starts
            remainingSeconds = totalSeconds;
            hasFlipped = false;
            timerDisplay.textContent = formatTime(remainingSeconds);
            // Start the timer immediately
            timerInterval = setInterval(updateTimer, 1000);
          } else if (startCookingBtn.textContent === 'Flip') {
            // User clicked flip, continue timer
            hasFlipped = true;
            // Hide button, show timer
            startCookingBtn.style.display = 'none';
            timerDisplay.style.display = 'block';
            timerInterval = setInterval(updateTimer, 1000);
          } else if (startCookingBtn.textContent === 'Done') {
            // Return to home view
            clearInterval(timerInterval);
            timerInterval = null;
            document.getElementById('timerView').style.display = 'none';
            document.getElementById('home-content').style.display = 'block';
            
            // Reset timer state
            remainingSeconds = totalSeconds;
            hasFlipped = false;
            startCookingBtn.textContent = 'Start';
            timerDisplay.style.display = 'none';
            startCookingBtn.style.display = 'block'; // Show button again for next time
          }
        });
      }

      initializeTimer(4);
    </script>
  </body>
</html>